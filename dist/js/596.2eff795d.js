"use strict";(self["webpackChunkcommunityproject"]=self["webpackChunkcommunityproject"]||[]).push([[596],{3596:function(e,o,s){s.r(o),s.d(o,{default:function(){return R}});var t=s(6768);const a=e=>((0,t.Qi)("data-v-75724d53"),e=e(),(0,t.jt)(),e),n={class:"app"},r=a((()=>(0,t.Lk)("header",{class:"header"},[(0,t.Lk)("h1",{class:"title"},"社区消息管理平台")],-1))),l={class:"footer"},c={class:"footer-content"},u=a((()=>(0,t.Lk)("p",null,"© 2024 社区消息管理平台",-1))),p={class:"footer-nav"};function i(e,o,s,a,i,d){const k=(0,t.g2)("LoginComponent"),m=(0,t.g2)("router-link");return(0,t.uX)(),(0,t.CE)("div",n,[r,(0,t.Lk)("div",null,[(0,t.bF)(k)]),(0,t.Lk)("footer",l,[(0,t.Lk)("div",c,[u,(0,t.Lk)("nav",p,[(0,t.bF)(m,{to:"/about",class:"footer-link"},{default:(0,t.k6)((()=>[(0,t.eW)("关于我们")])),_:1}),(0,t.bF)(m,{to:"/contact",class:"footer-link"},{default:(0,t.k6)((()=>[(0,t.eW)("联系我们")])),_:1}),(0,t.bF)(m,{to:"/privacy",class:"footer-link"},{default:(0,t.k6)((()=>[(0,t.eW)("隐私政策")])),_:1})])])])])}var d=s(5130),k=s(4232);const m=e=>((0,t.Qi)("data-v-735c8a9a"),e=e(),(0,t.jt)(),e),h={class:"login-container"},L={class:"login-box"},v={class:"login-form"},g=m((()=>(0,t.Lk)("h2",null,"登录",-1))),b={class:"user-box"},f=m((()=>(0,t.Lk)("label",null,"用户名",-1))),w={class:"user-box"},y=m((()=>(0,t.Lk)("label",null,"密码",-1))),S=m((()=>(0,t.Lk)("button",{type:"submit",class:"login-btn"},"登录",-1))),A={key:0,class:"error"},C={key:0,class:"popup-overlay"},_={class:"popup-content"},P={class:"popup-header"},I=m((()=>(0,t.Lk)("span",{class:"popup-title"},"成功",-1))),$=m((()=>(0,t.Lk)("div",{class:"popup-body"},[(0,t.Lk)("p",null,"登录成功！正在跳转到主页...")],-1)));function M(e,o,s,a,n,r){const l=(0,t.g2)("router-link");return(0,t.uX)(),(0,t.CE)("div",h,[(0,t.Lk)("div",L,[(0,t.Lk)("div",v,[g,(0,t.Lk)("form",{onSubmit:o[2]||(o[2]=(0,d.D$)(((...e)=>r.login&&r.login(...e)),["prevent"]))},[(0,t.Lk)("div",b,[(0,t.bo)((0,t.Lk)("input",{type:"text",name:"name",required:"","onUpdate:modelValue":o[0]||(o[0]=e=>n.name=e)},null,512),[[d.Jo,n.name]]),f]),(0,t.Lk)("div",w,[(0,t.bo)((0,t.Lk)("input",{type:"password",name:"password",required:"","onUpdate:modelValue":o[1]||(o[1]=e=>n.password=e)},null,512),[[d.Jo,n.password]]),y]),S,(0,t.Lk)("h5",null,[(0,t.eW)("还没有注册？"),(0,t.bF)(l,{to:"/enroll"},{default:(0,t.k6)((()=>[(0,t.eW)(" 去注册")])),_:1})]),n.errorMessage?((0,t.uX)(),(0,t.CE)("p",A,(0,k.v_)(n.errorMessage),1)):(0,t.Q3)("",!0)],32)])]),n.showSuccessPopup?((0,t.uX)(),(0,t.CE)("div",C,[(0,t.Lk)("div",_,[(0,t.Lk)("div",P,[I,(0,t.Lk)("button",{onClick:o[3]||(o[3]=(...e)=>r.closePopup&&r.closePopup(...e)),class:"popup-close-btn"},"×")]),$])])):(0,t.Q3)("",!0)])}s(4114);var W=s(4373),j={data(){return{name:"",password:"",errorMessage:"",showSuccessPopup:!1}},methods:{async login(){try{const e={name:this.name,password:this.password},o=await W.A.post("http://localhost:8090/login",e,{headers:{"Content-Type":"application/json"}}),{token:s,role:t}=o.data;localStorage.setItem("password",this.password),localStorage.setItem("token",s),localStorage.setItem("userRole",t),localStorage.setItem("username",this.name),W.A.defaults.headers.common["Authorization"]=`Bearer ${s}`,this.showSuccessPopup=!0,setTimeout((()=>{this.showSuccessPopup=!1,"MANAGER"===t?this.$router.push({name:"manager"}):"NORMAL"===t?this.$router.push({name:"user"}):this.$router.push({name:"home"})}),2e3)}catch(e){this.errorMessage=`登录失败：${e.response?e.response.data.error:e.message}`,console.error("登录失败:",e)}},closePopup(){this.showSuccessPopup=!1}},created(){const e=localStorage.getItem("token");e&&(W.A.defaults.headers.common["Authorization"]=`Bearer ${e}`)}},E=s(1241);const F=(0,E.A)(j,[["render",M],["__scopeId","data-v-735c8a9a"]]);var x=F,Q={name:"HomeWorld",components:{LoginComponent:x}};const X=(0,E.A)(Q,[["render",i],["__scopeId","data-v-75724d53"]]);var R=X}}]);
//# sourceMappingURL=596.2eff795d.js.map